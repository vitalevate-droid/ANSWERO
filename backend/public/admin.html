<!DOCTYPE html>
<html>
<head>
  <title>ANSWERO Dashboard</title>
  <style>
    body{
      margin:0;font-family:Arial,sans-serif;
      background:linear-gradient(135deg,#ede9fe,#fdfcff)
    }
    .topbar{
      padding:20px 40px;font-size:20px;font-weight:900;
      color:#5b21b6
    }
    .container{
      display:grid;grid-template-columns:1fr 420px;
      gap:30px;padding:40px
    }
    .panel{
      background:#fff;border-radius:24px;
      padding:30px;box-shadow:0 20px 50px rgba(0,0,0,.1)
    }
    .business-list{
      max-height:70vh;overflow-y:auto;margin-top:20px
    }
    .business-card{
      padding:14px;border-radius:14px;
      background:#f5f3ff;margin-bottom:12px;cursor:pointer
    }
    .business-card h4{margin:0;color:#4c1d95}
    .business-card span{
      font-size:11px;background:#ddd6fe;
      padding:4px 10px;border-radius:999px
    }
    input,textarea,button{
      width:100%;padding:14px;margin-top:14px;font-size:14px
    }
    textarea{resize:none;height:160px}
    button{
      background:#7c3aed;color:#fff;border:none;
      border-radius:999px;font-weight:600;cursor:pointer
    }
    .msg{margin-top:12px;color:#16a34a;font-size:13px}
  </style>
</head>
<body>

<div class="topbar">ANSWERO Admin Dashboard</div>

<div class="container">

  <div class="panel">
    <h3>Your Businesses</h3>
    <div class="business-list" id="list"></div>
  </div>

  <div class="panel">
    <h3>Add / Update Business</h3>
    <input id="secret" type="password" placeholder="Admin Secret">
    <input id="id">
    <input id="name">
    <input id="email">
    <textarea id="info"></textarea>
    <button onclick="save()">Save Business</button>
    <div class="msg" id="msg"></div>
  </div>

</div>

<script>
async function load(){
  if(!secret.value) return;
  const r=await fetch("/admin/list-businesses",{headers:{ "x-admin-secret":secret.value }});
  const d=await r.json();
  list.innerHTML="";
  Object.entries(d).forEach(([id,b])=>{
    const c=document.createElement("div");
    c.className="business-card";
    c.innerHTML=`<h4>${b.name}</h4><span>${id}</span>`;
    c.onclick=()=>{
      idInput.value=id;
      name.value=b.name;
      email.value=b.email;
      info.value=b.info;
    };
    list.appendChild(c);
  });
}
async function save(){
  await fetch("/admin/add-business",{
    method:"POST",
    headers:{ "Content-Type":"application/json","x-admin-secret":secret.value },
    body:JSON.stringify({
      id:idInput.value,name:name.value,email:email.value,info:info.value
    })
  });
  msg.innerText="Business saved successfully.";
  load();
}
const idInput=id;
secret.addEventListener("input",load);
</script>

</body>
</html>
