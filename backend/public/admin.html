<!DOCTYPE html>
<html>
<head>
  <title>ANSWERO Admin</title>
  <style>
    body{margin:0;font-family:Arial,sans-serif;background:linear-gradient(135deg,#ede9fe,#fdfcff)}
    header{padding:28px 40px;font-size:26px;font-weight:900;color:#5b21b6}
    main{padding:0 40px 40px}
    .card{background:#fff;border-radius:24px;padding:30px;box-shadow:0 20px 50px rgba(0,0,0,.1);margin-bottom:30px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:30px}
    .business-card{background:#f5f3ff;border-radius:16px;padding:16px;margin-bottom:12px;cursor:pointer}
    .business-card h4{margin:0;color:#4c1d95}
    .business-card span{font-size:11px;background:#ddd6fe;padding:4px 10px;border-radius:999px}
    input,textarea,button{width:100%;padding:14px;margin-top:12px;font-size:14px}
    textarea{resize:none;height:180px}
    button{background:#7c3aed;color:#fff;border:none;border-radius:999px;font-weight:600;cursor:pointer}
    .msg{margin-top:12px;color:#16a34a}
  </style>
</head>
<body>

<header>ANSWERO Dashboard</header>

<main>

  <div class="card">
    <label><strong>Admin Secret</strong></label>
    <input id="secret" type="password" placeholder="Enter admin secret">
  </div>

  <div class="grid">

    <div class="card">
      <h3>Your Businesses</h3>
      <div id="list"></div>
    </div>

    <div class="card">
      <h3>Add / Edit Business</h3>
      <label>Business ID</label>
      <input id="id" placeholder="e.g. coffee-shop-123">
      <label>Business Name</label>
      <input id="name" placeholder="e.g. Sunset Coffee">
      <label>Business Email</label>
      <input id="email" placeholder="contact@business.com">
      <label>Business Information (used by AI)</label>
      <textarea id="info" placeholder="Opening hours, services, location, policiesâ€¦"></textarea>
      <button onclick="save()">Save Business</button>
      <div class="msg" id="msg"></div>
    </div>

  </div>

</main>

<script>
async function load(){
  if(!secret.value)return;
  const r=await fetch("/admin/list-businesses",{headers:{"x-admin-secret":secret.value}});
  const d=await r.json();
  list.innerHTML="";
  Object.entries(d).forEach(([id,b])=>{
    const c=document.createElement("div");
    c.className="business-card";
    c.innerHTML=`<h4>${b.name||id}</h4><span>${id}</span>`;
    c.onclick=()=>{
      idInput.value=id;
      name.value=b.name||"";
      email.value=b.email||"";
      info.value=b.info||"";
    };
    list.appendChild(c);
  });
}
async function save(){
  await fetch("/admin/add-business",{method:"POST",headers:{"Content-Type":"application/json","x-admin-secret":secret.value},body:JSON.stringify({id:idInput.value,name:name.value,email:email.value,info:info.value})});
  msg.innerText="Business saved successfully.";
  load();
}
const idInput=id;
secret.addEventListener("input",load);
</script>

</body>
</html>
