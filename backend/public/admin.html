<!DOCTYPE html>
<html>
<head>
  <title>ANSWERO Admin</title>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      background: #f5f3ff;
    }

    h2 {
      color: #5b21b6;
    }

    .business {
      background: #fff;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,.1);
    }

    .business strong {
      color: #4c1d95;
    }

    button {
      margin-top: 10px;
      padding: 8px 14px;
      border: none;
      border-radius: 999px;
      background: #7c3aed;
      color: #fff;
      cursor: pointer;
      font-size: 13px;
    }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<h2>ANSWERO Admin Dashboard</h2>

<p><strong>Admin Secret</strong></p>
<input id="secret" type="password">

<h3>Add / Update Business</h3>

<input id="id" placeholder="Business ID">
<input id="name" placeholder="Business Name">
<input id="email" placeholder="Business Email">
<textarea id="info" placeholder="Business Information"></textarea>

<button onclick="save()">Save Business</button>

<h3>Your Businesses</h3>
<div id="list"></div>

<script>
const BASE_URL = "https://YOUR_RENDER_URL.onrender.com";

async function load() {
  if (!secret.value) return;

  const res = await fetch("/admin/list-businesses", {
    headers: { "x-admin-secret": secret.value }
  });

  const data = await res.json();
  list.innerHTML = "";

  Object.entries(data).forEach(([id, b]) => {
    const div = document.createElement("div");
    div.className = "business";

    div.innerHTML = `
      <strong>${b.name || id}</strong><br>
      <small>${id}</small><br>
      <button onclick="copyEmbed('${id}')">Copy Embed Code</button>
    `;

    list.appendChild(div);
  });
}

function copyEmbed(id) {
  const code =
`<script src="${BASE_URL}/answero-widget.js" data-business-id="${id}"></script>`;

  navigator.clipboard.writeText(code);
  alert("Embed code copied!");
}

async function save() {
  await fetch("/admin/add-business", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "x-admin-secret": secret.value
    },
    body: JSON.stringify({
      id: id.value,
      name: name.value,
      email: email.value,
      info: info.value
    })
  });

  load();
}

secret.addEventListener("input", load);
</script>

</body>
</html>
